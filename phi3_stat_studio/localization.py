"""Localization utilities for bilingual UI."""
from __future__ import annotations

from typing import Dict


_TRANSLATIONS: Dict[str, Dict[str, str]] = {
    "zh": {
        "app.title": "Phi-3 统计工作室",
        "menu.file": "文件",
        "menu.help": "帮助",
        "action.open_file": "打开数据文件",
        "action.run_analysis": "运行分析",
        "action.export_pdf": "导出 PDF",
        "action.export_html": "导出 HTML",
        "action.toggle_language": "切换语言",
        "action.ai_planner": "智能助手",
        "action.apply_chart": "应用图形设置",
        "label.selected_file": "已选择文件",
        "label.analysis_type": "分析类型",
        "label.target_column": "目标列",
        "label.group_column": "分组列",
        "label.numeric_columns": "数值列",
        "label.language": "语言",
        "label.results": "分析结果",
        "label.explanation": "解释",
        "label.code": "Python 代码",
        "label.plot": "图表",
        "label.report": "报告",
        "label.sample_data": "加载示例数据",
        "label.chart_settings": "图形设置",
        "label.chart_title": "图表标题",
        "label.palette": "配色",
        "label.font_size": "字体大小",
        "label.bins": "直方图柱数",
        "label.point_size": "点大小",
        "placeholder.instructions": "请输入您的问题或描述（例如：比较两个班级的平均成绩）。",
        "analysis.descriptive": "描述统计",
        "analysis.t_test_one_sample": "单样本 t 检验",
        "analysis.t_test_two_sample": "独立样本 t 检验",
        "analysis.histogram": "直方图",
        "analysis.scatter": "散点图",
        "wizard.step1": "步骤 1：导入数据",
        "wizard.step2": "步骤 2：选择分析",
        "wizard.step3": "步骤 3：查看结果",
        "error.invalid_file": "无法加载文件，请检查格式。",
        "error.no_numeric": "未找到数值列，请选择正确的数据。",
        "info.ready": "准备就绪，请选择分析任务。",
        "info.running": "分析运行中，请稍候...",
        "info.completed": "分析完成！",
        "report.title": "分析报告",
        "report.subtitle": "由 Phi-3 统计工作室生成",
        "explain.descriptive": "均值: {mean:.2f}，标准差: {std:.2f}。该统计量描述了变量的集中趋势与离散程度。",
        "explain.ttest_one": "t({df:.0f}) = {statistic:.2f}，p = {p_value:.3f}。若 p 小于显著性水平，则样本均值与参考值存在显著差异。",
        "explain.ttest_two": "t({df:.0f}) = {statistic:.2f}，p = {p_value:.3f}。较小的 p 值意味着两组均值存在统计学差异。",
    },
    "en": {
        "app.title": "Phi-3 Stat Studio",
        "menu.file": "File",
        "menu.help": "Help",
        "action.open_file": "Open Data File",
        "action.run_analysis": "Run Analysis",
        "action.export_pdf": "Export PDF",
        "action.export_html": "Export HTML",
        "action.toggle_language": "Toggle Language",
        "action.ai_planner": "AI Planner",
        "action.apply_chart": "Apply Chart Settings",
        "label.selected_file": "Selected File",
        "label.analysis_type": "Analysis Type",
        "label.target_column": "Target Column",
        "label.group_column": "Group Column",
        "label.numeric_columns": "Numeric Columns",
        "label.language": "Language",
        "label.results": "Results",
        "label.explanation": "Explanation",
        "label.code": "Python Code",
        "label.plot": "Chart",
        "label.report": "Report",
        "label.sample_data": "Load Sample Data",
        "label.chart_settings": "Chart Settings",
        "label.chart_title": "Chart Title",
        "label.palette": "Palette",
        "label.font_size": "Font Size",
        "label.bins": "Histogram Bins",
        "label.point_size": "Point Size",
        "placeholder.instructions": "Enter your question or description (e.g., compare the average scores of two classes).",
        "analysis.descriptive": "Descriptive Statistics",
        "analysis.t_test_one_sample": "One-sample t-test",
        "analysis.t_test_two_sample": "Independent t-test",
        "analysis.histogram": "Histogram",
        "analysis.scatter": "Scatter Plot",
        "wizard.step1": "Step 1: Import Data",
        "wizard.step2": "Step 2: Choose Analysis",
        "wizard.step3": "Step 3: View Results",
        "error.invalid_file": "Failed to load file. Please check the format.",
        "error.no_numeric": "No numeric columns detected. Please select appropriate data.",
        "info.ready": "Ready. Please choose an analysis task.",
        "info.running": "Analysis running. Please wait...",
        "info.completed": "Analysis completed!",
        "report.title": "Analysis Report",
        "report.subtitle": "Generated by Phi-3 Stat Studio",
        "explain.descriptive": "Mean: {mean:.2f}, Std: {std:.2f}. This describes the central tendency and spread of the selected variable.",
        "explain.ttest_one": "t({df:.0f}) = {statistic:.2f}, p = {p_value:.3f}. Compare the p-value with your significance level to decide whether the sample mean differs from the reference value.",
        "explain.ttest_two": "t({df:.0f}) = {statistic:.2f}, p = {p_value:.3f}. A small p-value suggests the two group means are statistically different.",
    },
}


def translate(key: str, language: str) -> str:
    """Translate key based on language with fallback."""
    lang_dict = _TRANSLATIONS.get(language) or _TRANSLATIONS["en"]
    return lang_dict.get(key, key)


def available_translations() -> Dict[str, Dict[str, str]]:
    return _TRANSLATIONS
